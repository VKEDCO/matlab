%% ========================================================================
%% Programmatic octave notes on "Ripples in Mathematics" by A. Jensen
%% and A. la Cour-Harbo written with a deep gratitude to the authors for
%% this wonderful text.
%% 
%% Reconstruction of graphs on p.27, Ch 04.
%%
%% Author: Vladimir Kulyukin
%% 
%% NB: I have tested this code in Octave, not Matlab.
%%
%% The numbers below were computed by my Java OneDHaar class methods
%% available at https://github.com/VKEDCO/java/blob/master/haar/org.vkedco.wavelets.haar/OneDHaar.java
%% and https://github.com/VKEDCO/java/blob/master/haar/org.vkedco.wavelets.tests/RipplesInMathCh04.java
%% =========================================================================

t = [0:511];

y_fig_4_3_d8_p27 = [
-0.017353269107199996
-0.017321916522383546
-0.017248833923443972
-0.01713419737276341
-0.01697828303983344
-0.016781466535938518
-0.016544222009275723
-0.016267121002689743
-0.01595083107677686
-0.015596114201672194
-0.015203824921397496
-0.014774908295189326
-0.014310397620768977
-0.01381141194503726
-0.013279153368193254
-0.012714904147768758
-0.012120023609558276
-0.011495944872883619
-0.010844171398084385
-0.010166273364549937
-0.009463883888019765
-0.008738695086265102
-0.007992454002628522
-0.007226958397243124
-0.006444052416071981
-0.005645622148198233
-0.004833591082071319
-0.004009915471655274
-0.003176579623640764
-0.002335591117077376
-0.0014889759669394682
-6.387737432781892E-4
2.129673422805805E-4
0.001064195370858105
0.0019128596595747276
0.002756915701824673
0.0035943300926715572
0.004423085427499176
0.005241185162115423
0.006046658422602499
0.006837564753324707
0.007611998791656501
0.008368094858166473
0.009104031451204694
0.00981803563505819
0.010508387311108232
0.011173423361699932
0.011811541656736901
0.012421204913353977
0.013000944399365983
0.013549363471571175
0.014065140940389582
0.014547034252721722
0.014993882485369262
0.01540460914180061
0.015778224745524917
0.016113829223828053
0.016410614076126505
0.016667864321714947
0.016884960222220188
0.017061378774602554
0.017196694971116006
0.017290582823191777
0.017342816146770284
0.017353269107199934
0.017321916522383803
0.017248833923443913
0.017134197372763352
0.01697828303983336
0.016781466535938476
0.016544222009275644
0.016267121002689743
0.015950831076776823
0.015596114201672468
0.015203824921397416
0.014774908295189248
0.014310397620769135
0.01381141194503726
0.013279153368193254
0.01271490414776868
0.012120023609558198
0.01149594487288354
0.010844171398084307
0.010166273364549859
0.009463883888019843
0.00873869508626518
0.007992454002628444
0.007226958397243124
0.006444052416072216
0.005645622148198233
0.004833591082071398
0.004009915471655196
0.003176579623640764
0.002335591117077533
0.0014889759669393897
6.387737432781892E-4
-2.129673422805805E-4
-0.001064195370858105
-0.001912859659574649
-0.0027569157018245945
-0.0035943300926715572
-0.004423085427499097
-0.005241185162115344
-0.006046658422602421
-0.006837564753324707
-0.007611998791656344
-0.008368094858166473
-0.009104031451204773
-0.009818035635058111
-0.010508387311108624
-0.011173423361699854
-0.011811541656736901
-0.012421204913353977
-0.013000944399365747
-0.013549363471571175
-0.014065140940389582
-0.014547034252721644
-0.014993882485369262
-0.015404609141800573
-0.015778224745524917
-0.016113829223828643
-0.01641061407612619
-0.016667864321714947
-0.016884960222220188
-0.017061378774602242
-0.01719669497111664
-0.017290582823191777
-0.017342816146770287
-0.017353269107199937
-0.017321916522383487
-0.017248833923443924
-0.017134197372763352
-0.01697828303983336
-0.016781466535938438
-0.016544222009275644
-0.016267121002689705
-0.015950831076776823
-0.015596114201672194
-0.015203824921397416
-0.014774908295189248
-0.01431039762076882
-0.013811411945037731
-0.013279153368193254
-0.012714904147768758
-0.012120023609558198
-0.011495944872883619
-0.010844171398084385
-0.010166273364549859
-0.009463883888019765
-0.008738695086265102
-0.007992454002628444
-0.007226958397243045
-0.006444052416072216
-0.005645622148198233
-0.004833591082071398
-0.004009915471655274
-0.003176579623640764
-0.0023355911170774546
-0.0014889759669393897
-6.387737432781892E-4
2.129673422805805E-4
0.001064195370858105
0.001912859659574649
0.0027569157018247515
0.0035943300926717142
0.004423085427499333
0.005241185162115187
0.006046658422602185
0.006837564753324471
0.00761199879165603
0.00836809485816616
0.009104031451205008
0.009818035635058425
0.010508387311108624
0.011173423361700324
0.011811541656737293
0.01242120491335437
0.013000944399365277
0.013549363471570703
0.014065140940389034
0.014547034252721094
0.014993882485369812
0.015404609141801123
0.015778224745525503
0.016113829223828605
0.01641061407612678
0.016667864321715537
0.016884960222219577
0.01706137877460163
0.017196694971115385
0.01729058282319115
0.017342816146769663
0.017353269107200565
0.01732191652238411
0.01724883392344454
0.01713419737276398
0.016978283039833987
0.016781466535939066
0.016544222009275016
0.016267121002689115
0.015950831076776233
0.015596114201671644
0.015203824921396868
0.014774908295189798
0.01431039762076937
0.013811411945037731
0.013279153368193648
0.01271490414776923
0.012120023609557728
0.011495944872883149
0.010844171398083913
0.010166273364549467
0.00946388388801945
0.008738695086265494
0.00799245400262868
0.007226958397243359
0.006444052416072216
0.00564562214819839
0.004833591082071555
0.004009915471655117
0.003176579623640607
0.0023355911170772972
0.0014889759669393112
6.387737432781107E-4
-2.129673422805805E-4
-0.001064195370858105
-0.0019128596595747276
-0.0027569157018247515
-0.0035943300926717142
-0.004423085427499333
-0.005241185162115187
-0.006046658422602185
-0.006837564753324471
-0.00761199879165603
-0.008368094858166081
-0.009104031451205087
-0.009818035635058425
-0.010508387311108546
-0.011173423361700246
-0.011811541656737371
-0.012421204913354448
-0.013000944399365277
-0.01354936347157078
-0.014065140940389034
-0.014547034252721094
-0.014993882485369812
-0.015404609141801123
-0.015778224745525503
-0.016113829223828605
-0.01641061407612678
-0.016667864321715537
-0.016884960222219556
-0.01706137877460163
-0.017196694971115395
-0.01729058282319115
-0.017342816146769656
];


figure;
plot(0:1:255, y_fig_4_3_d8_p27);
title("D8: Fig 4.3, d8, p. 27 in Ripples");
xlim([0 255]);

y_fig_4_3_d7_p27 = [
-0.04904550470208658
-0.04863227384344307
-0.047750687602582144
-0.046409236136927164
-0.04462083835740445
-0.042402717512268644
-0.03977623531780623
-0.036766686233331375
-0.033403053861714625
-0.029717731821442696
-0.025746211778365728
-0.02152674164155185
-0.017099957215016028
-0.012508490852711891
-0.00779656088565971
-0.0030095457752448364
0.0018064529061707722
0.006605054458592284
0.011340045725887418
0.015965826153743066
0.02043784694792932
0.02471304010354362
0.028750233173438902
0.0325105457813979
0.035957764061409686
0.03905868941699677
0.041783458241846774
0.04410582952266639
0.04600343755448325
0.04745800733461338
0.04845553056092583
0.048986400539449124
0.04904550470208663
0.048632273843442916
0.04775068760258195
0.046409236136927476
0.04462083835740461
0.04240271751226841
0.039776235317806385
0.03676668623333169
0.033403053861714625
0.029717731821443168
0.025746211778365415
0.02152674164155169
0.017099957215016184
0.012508490852712047
0.00779656088565971
0.0030095457752448364
-0.0018064529061707722
-0.006605054458592441
-0.011340045725887418
-0.01596582615374291
-0.02043784694792932
-0.02471304010354362
-0.028750233173438902
-0.03251054578139759
-0.03595776406140961
-0.0390586894169974
-0.0417834582418467
-0.044105829522666
-0.046003437554483446
-0.04745800733461342
-0.04845553056092601
-0.04898640053944869
-0.049045504702086413
-0.04863227384344382
-0.04775068760258195
-0.046409236136927046
-0.0446208383574043
-0.04240271751226841
-0.03977623531780647
-0.036766686233331375
-0.033403053861714625
-0.029717731821443168
-0.025746211778365415
-0.02152674164155185
-0.017099957215016184
-0.012508490852711891
-0.007796560885659553
-0.0030095457752448364
0.0018064529061707722
0.006605054458592441
0.011340045725887574
0.01596582615374275
0.020437846947929477
0.024713040103543936
0.028750233173438902
0.03251054578139759
0.03595776406141016
0.03905868941699685
0.04178345824184748
0.044105829522666076
0.04600343755448309
0.0474580073346142
0.048455530560925615
0.04898640053944869
0.0490455047020864
0.04863227384344295
0.04775068760258195
0.046409236136927046
0.04462083835740437
0.04240271751226935
0.03977623531780615
0.036766686233331375
0.033403053861714466
0.029717731821442696
0.025746211778366043
0.02152674164155169
0.017099957215015872
0.012508490852712205
0.007796560885659553
0.0030095457752446794
-0.0018064529061707722
-0.006605054458592284
-0.011340045725887574
-0.01596582615374291
-0.02043784694792932
-0.024713040103543936
-0.028750233173438902
-0.03251054578139759
-0.03595776406141016
-0.039058689416996695
-0.041783458241847406
-0.044105829522666076
-0.046003437554483134
-0.0474580073346142
-0.048455530560925594
-0.04898640053944869
];

figure;
plot(0:1:127, y_fig_4_3_d7_p27);
title("D7: Fig 4.3, d7, p. 27 in Ripples");
xlim([0 127]);

y_fig_4_3_d6_p27 = [
-0.1382205356729931
-0.13324253778085945
-0.12314410388508332
-0.10831331113701251
-0.08932009858475111
-0.06689436473516598
-0.041897917963600595
-0.015291357701316859
0.011902840861936378
0.03863961992605535
0.06389150006576436
0.08668806568871212
0.10615325756246972
0.12153903927953467
0.13225414387696569
0.13788679589418307
0.1382205356729931
0.13324253778085923
0.12314410388508332
0.10831331113701283
0.08932009858475126
0.06689436473516598
0.041897917963600435
0.015291357701316859
-0.01190284086193622
-0.03863961992605488
-0.06389150006576436
-0.08668806568871212
-0.10615325756247004
-0.12153903927953467
-0.13225414387696544
-0.13788679589418357
-0.13822053567299325
-0.13324253778085893
-0.12314410388508293
-0.10831331113701298
-0.08932009858475126
-0.06689436473516583
-0.041897917963600435
-0.015291357701317173
0.01190284086193622
0.03863961992605519
0.06389150006576451
0.08668806568871165
0.10615325756246989
0.121539039279535
0.13225414387696582
0.13788679589418265
0.13822053567299264
0.1332425377808602
0.12314410388508332
0.10831331113701204
0.08932009858475064
0.06689436473516598
0.041897917963600595
0.015291357701317015
-0.011902840861936378
-0.03863961992605519
-0.06389150006576436
-0.08668806568871165
-0.10615325756247004
-0.121539039279535
-0.13225414387696582
-0.13788679589418262
];

figure;
plot(0:1:63, y_fig_4_3_d6_p27);
title("D6: Fig 4.3, d6, p. 27 in Ripples");
xlim([0 63]);

y_fig_4_3_s6_p27 = [
0.24228789181051738
0.7865275324466248
1.30054136110053
1.7645761145993404
2.1607991975997836
2.473983979226618
2.692094943957973
2.8067502097372614
2.8135436389999984
2.7122141640694157
2.506655819840873
2.2047680982046236
1.818152375002565
1.3616660756607568
0.8528517126624386
0.3112627366312535
-0.242287891810517
-0.7865275324466247
-1.3005413611005299
-1.7645761145993402
-2.1607991975997836
-2.473983979226618
-2.692094943957973
-2.8067502097372614
-2.8135436389999984
-2.712214164069416
-2.506655819840873
-2.2047680982046236
-1.8181523750025657
-1.3616660756607575
-0.8528517126624388
-0.3112627366312537
0.24228789181051652
0.7865275324466239
1.30054136110053
1.7645761145993402
2.1607991975997836
2.473983979226618
2.692094943957973
2.806750209737261
2.8135436389999984
2.7122141640694166
2.506655819840873
2.204768098204624
1.8181523750025657
1.3616660756607573
0.8528517126624395
0.31126273663125437
-0.24228789181051674
-0.7865275324466237
-1.3005413611005292
-1.7645761145993395
-2.1607991975997836
-2.473983979226618
-2.692094943957973
-2.806750209737261
-2.8135436389999984
-2.7122141640694166
-2.5066558198408737
-2.204768098204624
-1.8181523750025663
-1.3616660756607575
-0.8528517126624399
-0.3112627366312547
];

figure;
plot(0:1:63, y_fig_4_3_s6_p27);
title("S6: Fig 4.3, s6, p. 27 in Ripples");
xlim([0 63]);

figure;
plot(0:1:63, y_fig_4_3_s6_p27);
title("S6: Fig 4.3, s6, p. 27 in Ripples");
xlim([0 63]);

figure;
subplot(4, 1, 1);
plot(0:1:255, y_fig_4_3_d8_p27);
xlim([0 255]);

legend('d8', 'location', 'north');
subplot(4, 1, 2);
plot(0:1:127, y_fig_4_3_d7_p27);
xlim([0 127]);

legend('d7', 'location', 'north');
subplot(4, 1, 3);
plot(0:1:63, y_fig_4_3_d6_p27);
xlim([0 63]);

legend('d6', 'location', 'north');
subplot(4, 1, 4);
plot(0:1:63, y_fig_4_3_s6_p27);
xlim([0 63]);

legend('s6', 'location', 'north');
title('Fig. 4.3. The wavelet coefficients from Fig. 4.2.');

