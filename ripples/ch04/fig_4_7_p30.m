%% ========================================================================
%% Programmatic octave notes on "Ripples in Mathematics" by A. Jensen
%% and A. la Cour-Harbo written with a deep gratitude to the authors for
%% this wonderful text.
%% 
%% Reconstruction Figure 4.7, p. 30, Ch 04.
%%
%% Author: Vladimir Kulyukin
%% 
%% NB: I have tested this code in Octave 4.
%%
%% The numbers below were computed by my Java OneDHaar class methods
%% available at https://github.com/VKEDCO/java/blob/master/haar/org.vkedco.wavelets.haar/OneDHaar.java &
%% https://github.com/VKEDCO/java/blob/master/haar/org.vkedco.wavelets.tests/RipplesInMathCh04.java
%% =========================================================================
t = [0:511];

y_fig_4_7 = [
0.1799004422119564
0.3486557222648638
0.259401402309525
0.14319531688416928
0.36652515056981805
0.2947073798453206
0.3119750871703886
0.5353814423569772
0.30409057025408015
0.39307151928906225
0.4357861479588686
0.5193406975726056
0.6755694887549106
0.8090994381820633
0.7525869555488036
0.7758268356238709
0.7173866037046508
0.6355936259668036
0.755912417129301
0.9242009754946767
0.8041703787401612
0.8267622865216944
0.6203688084704415
0.8478485992529659
1.005776048148335
0.7355676789215226
1.0560163993401406
0.6951414972079524
0.9723079869014645
0.7699862624103513
1.0638179760664028
0.7220973665641961
0.9447638011060634
0.8326246396169862
0.8353325038130803
1.0496284056587197
1.1464425152640967
0.9976858959033501
1.1926652725042304
1.2056333106249235
1.2834033339997741
1.309456840222185
0.8831427481851282
1.0101752895000025
1.3710313506256726
1.157287357285285
1.227262601944053
0.9406022912978935
1.108160795292003
1.3934589993853164
1.0681762215209323
1.082703583620839
1.0402262429236164
1.212390527470265
1.1862931415911668
1.1338604132189056
1.2885565553026548
1.3023040627795148
1.3235538624881447
1.1746365201146944
1.1741958382804385
1.413776288552103
1.2084996351084059
1.0663677904992366
1.1315304360836134
1.2635248949484792
1.4854746365780884
1.36404841007755
1.3895204085972217
1.1063310999028044
1.2291282174224658
1.0561743150319631
0.9964782677993853
1.3631752820665044
1.2688418213336208
1.256192995755507
1.3781078205724344
1.3894630167659163
1.356787187775761
1.1738219379157815
1.2479098396902277
1.3036450788481257
1.288029642378165
1.2887363649728745
1.334081466193286
1.2735854047014887
0.9214221461694453
1.1339902151401753
1.047680216233541
1.2757070349413244
1.1559928709153366
0.9720224438626885
0.8930935035953872
1.1002466907881718
0.789111245043576
0.9122142445992707
1.1137486762927027
0.7748746160152626
0.8199241587055933
0.6757009703047054
0.7735185421194354
0.6184867707098002
0.6643863704420553
0.7605057581674151
0.6974215100876582
0.8171526595058494
0.9166659816779247
0.6980502002058493
0.9339852402148274
0.7350026369800284
0.7257880403263108
0.4207108621958963
0.656037208789964
0.6342641866488862
0.5560860740531892
0.4793283028761081
0.6867050462625542
0.5807078644465944
0.5653639410429998
0.45943913098135797
0.6230541137229723
0.5534389691861212
0.5656267724492141
0.44548931671625286
0.3310592535099567
0.16127200413533238
0.5278222981032844
0.27340072663407355
0.4025023150261643
0.39185074626567856
0.3542406551611862
0.09360088091167369
-0.0030935510511986702
-0.015772488853598818
0.17005288398944263
-0.06101069488727259
-0.16023731600387037
-0.17920900816061083
0.1789253218312402
0.05530203570154396
0.012074061994770902
0.1802327030226346
-0.3132708458031801
-0.29505060140917644
0.04563680451637997
-0.2203317525202163
-0.27792858311788365
-3.600196111260834E-4
-0.26650217519049846
-0.2389202533826208
-0.2272942568615412
-0.44803248890188374
-0.5243278695462067
-0.3550777908952215
-0.48716182703968736
-0.1383747548790873
-0.5935264408251975
-0.21796298738970332
-0.48207451094425924
-0.6319739813981151
-0.5082936449645796
-0.5160584371247587
-0.6492296078396327
-0.4921558507956218
-0.7585148349098747
-0.6988851655486805
-0.44445008657270246
-0.5866411455424606
-0.34240506543086724
-0.6509253740253331
-0.4851293056916328
-0.4245328854470789
-0.4769276097084953
-0.8471572941400457
-0.6909736450759977
-0.6261530901322545
-0.8539153325155857
-0.8081798684545289
-0.8336603596259715
-0.6540094939202417
-0.8097993494867568
-0.8208545037443001
-0.6911961837906635
-0.5733097805054866
-0.7412050546736937
-0.8977148926527949
-0.5218050998394537
-0.8599521012443251
-0.5474061816348341
-0.8150958223153622
-0.8255918660236059
-0.632807901989749
-0.8137329350791944
-0.7960053835171552
-0.8500204070375745
-0.6553743899633669
-0.8675105022548364
-0.9892146913291378
-0.5174147492786996
-0.529510918531622
2.2408249978224806
-0.8408634812578926
-0.9092326691210912
-0.6909851629311689
-0.9537259859816561
-0.7590786270061659
-0.6327804539759176
-0.6129419191425394
-0.42629275145347284
-0.6356776814909956
-0.8213300505373391
-0.5291687349352969
-0.6345476009221709
-0.8119780138415685
-0.6782680180770115
-0.5041696505684596
-0.5250852328343076
-0.45805681793685266
-0.3699483494586633
-0.30156978279382546
-0.47859340647690074
-0.5765062579612099
-0.7003395160067947
-0.23626045463481132
-0.4447578881096595
-0.4428023513583835
-0.3633490807277201
-0.5389560936972824
-0.15660723690826595
-0.25485541488931107
-0.16587672875815834
-0.21447094594631666
-0.11007325804148066
-0.084134044977424
-0.44619032767120714
-0.4370353999042461
-0.25577339914167757
-0.3999538777049172
0.021863222588919096
-0.19735835077246638
-0.09562680432096249
0.022903335116482793
0.04800700516676926
-0.1969038753674056
-0.10689641999448357
0.10512571301097856
-0.15743009135966216
0.12501285794526806
-0.1306045898777591
-0.0930766633052506
0.23689326069351055
0.04619392832241018
-0.06000062170759769
-0.06694165984047819
0.40917416174405036
0.004587585838243827
0.15213626050745652
0.24064051654470414
0.48001851493859504
0.31711299831598627
0.48109435829805414
0.4560270589125274
0.3698087897639162
0.634378677533763
0.4746076988698401
0.6123404794031134
0.6034485825897291
0.6543813336113675
0.5796650283185089
0.6649196849756681
0.8071279817096871
0.5718846985735536
0.556794001565508
0.6284450315470542
0.46646093471327765
0.5844163993407824
0.7818845689301221
0.5065289159166468
0.6056776711529871
1.010684255786439
0.6462601295876065
1.0522390964065713
0.90351243890946
0.7027014757097421
0.6919744771332407
0.9063229801714917
0.8830087052806601
0.9490237339819696
1.0612072149791962
0.8088267431512204
1.199671104944367
0.9732391785320127
0.7961496105295357
0.8693538866100881
1.2052253543975382
0.9292159399813693
0.9989178076990595
1.3113837938471453
0.8827045060005043
0.9825997510977212
1.3497993701467224
1.176871443327358
0.9326619639243667
1.146667775334595
0.9865340334178081
1.1887753977292883
1.2400183831914677
1.009882955447138
1.2673489469667227
1.3212118665182815
1.1663822552040106
1.352356354426044
1.4761131976477877
1.1196084050996324
1.09364035382943
1.3989136155977557
1.0792459277882522
1.4465316961158758
1.3911966444665085
1.0975743786651098
1.2109070795874288
1.102789679138344
1.491445276714284
1.34399249625766
1.145519094843645
1.1879588526224716
1.0358951276470212
0.9947674295302871
1.114812557128248
1.119663626428379
1.0978205512726615
1.3255261596874748
1.4403584098929767
1.4267352752029137
1.2963951106553426
1.2932877942885446
1.0819436161997822
1.2678038837369046
1.1919718019570535
1.0568614789063793
1.3471670762060493
1.1039272081319231
1.1925056598472548
1.1938916574902063
1.168276737419986
1.0715367634426878
0.8070715436733056
0.9286526742525136
1.028538781458843
0.860281454149401
0.9540117531803434
0.9508084723823008
0.8123238731367746
0.7992756089076765
1.168455589341736
1.0620908651098084
1.0606154788905733
0.8948083852143851
0.9567845325664321
0.9352137379093972
0.8367893316514201
0.7427479742618448
0.7140740856510903
0.7073283144303796
0.6462830263596486
0.5596741567019166
0.5546253078317002
0.458938242527688
0.6081690214701194
0.5381990768909506
0.605405917320858
0.3484314191630707
0.34666404003073764
0.3339866866786187
0.277553128981608
0.2822487178014456
0.35625218961962213
0.23465688259394973
0.2620472420688247
0.5011981985951819
0.39536893271986606
0.4440616673839054
0.4922471899834562
0.35453651560536004
0.2804873097755136
0.4393458455913767
0.07818607209078166
0.3151776155110114
0.28496748494990626
0.02275605581539046
0.24535694873866884
-0.0382478716959318
0.19517523538360132
-0.004662662202278928
0.10417617939997159
0.21622892587885112
-0.05985556894289834
-0.1745424527110357
0.13539332779298802
0.07942407071064217
0.09045321927386579
-0.22847455299562897
-0.3985757951162594
-0.04904001651510753
-0.08299699369973162
-0.35468082098749115
-0.3160848023904323
-0.1448984231657649
-0.3889659478610554
-0.2299823248120822
-0.4961958197324031
-0.4806159923024114
-0.3070192493270477
-0.3046717610910263
-0.19827444258254445
-0.230939946429847
-0.4203354482399757
-0.6189706466049572
-0.5561863510208195
-0.3928664544340875
-0.7631583914975593
-0.6502014760804213
-0.4292089812472244
-0.35289170538648407
-0.6827328483714339
-0.7596292232408468
-0.37331503067886446
-0.7464295274796203
-0.8267922459777932
-0.7371258020188485
-0.8124019847421696
-0.6756644667526372
-0.8632724951587164
-0.7303853775592932
-0.5393355770766664
-0.8828707882485123
-0.5189066021621064
-0.4933675285744636
-0.9613422551166595
-0.6163649311265087
-0.4877101534387111
-0.8959696383620561
-0.5233294341554062
-0.6757702574620099
-0.7090982247182461
-0.5036290097531309
-0.9961296792253425
-0.9821599347942975
-0.9484796969019932
-0.7616294393259588
-0.8044584736690086
-0.9869054492241456
-0.5306556209101763
-0.9043361993142004
-0.7915427851844881
-0.8106949836218014
-0.9782034833668594
-0.654407792642089
-0.7739208336514336
-0.6911975502883999
-0.6932599682883949
-0.581231692493305
-0.9308314283792656
-0.614235562655308
-0.6917200808527934
-0.6514058863353138
-0.4979041319473188
-0.40909033956365026
-0.7538510651937305
-0.5270370369368744
-0.39452959166574114
-0.6037015378827136
-0.6946750959774263
-0.5499504777311018
-0.30833227781429073
-0.4600334198752117
-0.2812050222340783
-0.5916062125417332
-0.3885858558048894
-0.343767599574336
-0.6317230949456503
-0.5495896406592451
-0.5632044748332059
-0.42574344762260435
-0.22477295406041248
-0.2319947673140601
-0.5911110877870839
-0.16520435191501798
-0.4223907297310206
-0.19084187957804472
-0.2933270327336981
-0.0869193770791239
-0.17333153915799565
-0.24487095680651288
0.027955001492994402
-0.03563706661585597
-0.30765312066480915
0.029373713613957686
-0.32724050842751407
0.12791060823240508
-0.06399880322274837
0.16130296636581548
-0.21504501558878863
0.035099175151391854
0.2947224033586206
0.07069742141786034
0.1388533523570688
0.1677307220519506
0.22283046753139263
0.22188914428914996
0.3540973196734125
0.10382779199306873
];

figure;
plot(t, y_fig_4_7);
xlim([0 511]);
title('Fig. 4.7: Sine plus impulse at 200 plus noise, p. 30');
