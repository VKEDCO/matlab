%% ========================================================================
%% Programmatic octave notes on "Ripples in Mathematics" by A. Jensen
%% and A. la Cour-Harbo written with a deep gratitude to the authors for
%% this wonderful text. 
%% 
%% Reconstruction of graphs in Figure 4.9, p.31, Ch 04.
%%
%% Author: Vladimir Kulyukin
%% 
%% NB: I have tested this code in Octave 4.
%%
%% The numbers below were computed by my Java OneDHaar class methods
%% available at https://github.com/VKEDCO/java/blob/master/haar/org.vkedco.wavelets.haar/OneDHaar.java &
%% https://github.com/VKEDCO/java/blob/master/haar/org.vkedco.wavelets.tests/RipplesInMathCh04.java
%% =========================================================================


t = [0:511];

y_fig_4_9_inverted_p31 = [
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.18826697606311682
-0.18826697606311682
0.0
0.0
0.0
0.0
0.0
0.0
0.15669367437069734
-0.15669367437069734
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.21739772128915424
-0.21739772128915424
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.12368650150258718
0.12368650150258718
-0.12368650150258718
-0.12368650150258718
1.2209229515189943
1.2209229515189943
1.2209229515189943
1.2209229515189943
1.2209229515189943
1.2209229515189943
1.2209229515189943
1.2209229515189943
1.2749230655988466
1.2749230655988466
1.2749230655988466
1.2749230655988466
1.2749230655988466
1.2749230655988466
1.2749230655988466
1.2749230655988466
1.2060857790247541
1.2060857790247541
1.2060857790247541
1.2060857790247541
1.2060857790247541
1.2060857790247541
1.2060857790247541
1.2060857790247541
1.2225464571515388
1.2225464571515388
1.2225464571515388
1.2225464571515388
1.3367885265396777
1.3367885265396777
1.1083043877633998
1.1083043877633998
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.1931613085096281
-0.1931613085096281
0.0
0.0
0.0
0.0
0.0
0.0
0.16412334988276514
0.16412334988276514
0.16412334988276514
0.16412334988276514
-0.16412334988276514
-0.16412334988276514
0.022850399852025832
-0.3510970996175561
0.10419094468491222
0.10419094468491222
0.10419094468491222
0.10419094468491222
-0.10419094468491222
-0.10419094468491222
0.140339713323114
-0.34872160269293845
0.23739140266851672
-0.23739140266851672
0.22359339206608783
-0.22359339206608783
0.0
0.0
0.16570733337120733
-0.16570733337120733
0.10908788102608943
0.10908788102608943
0.10908788102608943
0.10908788102608943
-0.10908788102608943
-0.10908788102608943
-0.10908788102608943
-0.10908788102608943
0.0
0.0
0.2375839531360621
-0.2375839531360621
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.15386457178626142
-0.15386457178626142
0.0
0.0
0.10069817584596645
0.10069817584596645
-0.10069817584596645
-0.10069817584596645
0.18752601780171502
0.18752601780171502
-0.18752601780171502
-0.18752601780171502
0.14703205978530381
0.14703205978530381
-0.14703205978530381
-0.14703205978530381
0.15555227977699845
-0.15555227977699845
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.16152909130483145
-0.16152909130483145
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.10794241162702303
0.10794241162702303
-0.10794241162702303
-0.10794241162702303
0.0
0.0
0.0
0.0
2.7825345348272594
-0.25607656173094506
-0.3918689692455188
-0.3918689692455188
-0.43568000865131923
-0.43568000865131923
-0.43568000865131923
-0.43568000865131923
0.0
0.0
0.22837840892566288
-0.22837840892566288
0.0
0.0
0.0
0.0
0.16743444039330863
0.16743444039330863
-0.16743444039330863
-0.16743444039330863
0.0
0.0
0.15033091307096766
-0.15033091307096766
0.10574440940362667
0.10574440940362667
-0.10574440940362667
-0.10574440940362667
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.21678773277569371
-0.21678773277569371
0.0
0.0
0.1664275746823486
-0.1664275746823486
0.0
0.0
1.2390596161084355
1.2390596161084355
1.2390596161084355
1.2390596161084355
1.2390596161084355
1.2390596161084355
1.2390596161084355
1.2390596161084355
1.4088057793759319
1.0373435474836232
1.2230746634297776
1.2230746634297776
1.2230746634297776
1.2230746634297776
1.2230746634297776
1.2230746634297776
1.2772650144770032
1.2772650144770032
1.2772650144770032
1.2772650144770032
1.2772650144770032
1.2772650144770032
1.2772650144770032
1.2772650144770032
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.09961310873262516
0.09961310873262516
-0.09961310873262516
-0.09961310873262516
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.09610805951821622
0.09610805951821622
-0.09610805951821622
-0.09610805951821622
0.0
0.0
0.0
0.0
0.19894835352900953
-0.19894835352900953
0.0
0.0
0.0
0.0
0.24405857578772408
-0.24405857578772408
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.1482124114678281
0.1482124114678281
-0.1482124114678281
-0.1482124114678281
0.10581301763257167
0.10581301763257167
-0.10581301763257167
-0.10581301763257167
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.13721764721607418
0.13721764721607418
0.33200099492786717
-0.05756570049571877
-0.13721764721607418
-0.13721764721607418
-0.13721764721607418
-0.13721764721607418
0.13595657132354338
0.13595657132354338
0.13595657132354338
0.13595657132354338
-0.13595657132354338
-0.13595657132354338
-0.13595657132354338
-0.13595657132354338
0.3374004229695014
-0.08812584304289406
0.12463728996330367
0.12463728996330367
-0.12463728996330367
-0.12463728996330367
-0.12463728996330367
-0.12463728996330367
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.17987210777107815
-0.17987210777107815
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.1801724897555556
-0.1801724897555556
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.2103853542023699
-0.2103853542023699
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.01393762771818939
0.01393762771818939
0.01393762771818939
0.01393762771818939
0.10262809629337465
0.10262809629337465
0.2818781135339985
0.2240499403791759
];

figure;
plot(t, y_fig_4_9_inverted_p31);
xlim([0 511]);
title('Fig. 4.9: Sine plus impulse at 200 plus noise, reconstruction based on the largest 10% of the coefficients, Haar transform');



